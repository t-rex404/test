# リポジトリ ガイドライン

## プロジェクト構成とモジュール構成
自動化シナリオは `_ps` にあり、目的別にグループ化されています（例: 回帰用の `test_*.ps1`）。共通のドライバーとヘルパーは `_ps\_lib` に配置され、`. "$PSScriptRoot\_lib\Common.ps1"` を通じて読み込む必要があります。静的ドキュメント出力は `_docs` に公開され、`_json/ErrorCode.json` には実行時に利用される中央管理のエラー メタデータが保存されます。`_log\ai_*.log` などのログは実行中に生成されるため、作業を共有する際はサイズを抑えてください。リポジトリ直下の `run.cmd` などのアセットはローカル実行フローを支援します。

## ビルド、テスト、および開発コマンド
リポジトリのルートで `run.cmd` を使用して既定のスモーク シナリオ（`_ps\aaa.ps1`）を起動します。特定のスクリプトを直接実行する場合は `powershell.exe -ExecutionPolicy Bypass -File _ps\<script>.ps1` を使用し、カバレッジのために `test_*` スイートを優先します。新しいシナリオを作成する際は、環境設定・構成・ログ記録を準備するため、必ず最初に `_ps\_lib\Common.ps1` を読み込んでください。

## コーディング スタイルと命名規則
既存のクラス形式モジュールと揃えるため、インデントは 4 スペース、波括弧は独立した行に配置します。クラスや関数は PascalCase（`WebDriver`, `InitSession`）、ローカル変数は camelCase（`sessionId`）、定数は ALL_CAPS のみを使用します。スクリプトは `verb_TargetScenario.ps1`（例: `test_Login.ps1`）という形式に従ってください。コメントは簡潔にし、バイリンガル出力が必要な場合を除き英語で記述します。

## テスト ガイドライン
各 `test_*` スクリプトを実行可能な仕様として扱い、セットアップとクリーンアップは `_ps\_lib` のヘルパー内にカプセル化し、`$global:Common.WriteLog` でチェックポイントを出力します。新しいドライバーを検証する際は、スモーク スクリプトと少なくとも 1 つの回帰シナリオで確認します。実行時に UI やログの洞察が得られた場合は、説明資料を `_docs\pages` に保存してください。

## コミットとプルリクエストのガイドライン
過去に見られる短いコミット サブジェクト（例: `mod file`, `fix loader`）を踏襲し、72 文字以内に収め、該当する場合は課題 ID を参照してください。プルリクエストでは範囲を説明し、変更したスクリプトを列挙し、実行した `test_*` のコンソールまたはログ抜粋を添付します。`ErrorCode.json` を更新した場合は、デプロイ時にレビュアーが `Common.LoadErrorCodes()` を実行する必要がある旨を記載してください。

## セキュリティと構成のヒント
機密性の高いエンドポイントや資格情報はリポジトリの外部に保管し、パラメーターまたは安全なローカル ストアを通じて公開してください。コミット前には `_log` から大きなトレースを削除し、差分を明瞭に保ちます。共通設定を変更する場合は、`Common.ps1` とその先の利用者にまで変更が伝播することを確認してください。
