<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChromeDriver - PowerShell Driver Classes</title>
    <link rel="stylesheet" href="../css/styles.css">
    <style>
        .method-section {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-medium);
        }
        
        .method-card {
            background: linear-gradient(145deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .method-name {
            font-size: 1.3em;
            color: var(--text-accent);
            margin-bottom: 10px;
            font-family: 'Courier New', monospace;
        }
        
        .code-example {
            background: rgba(0,0,0,0.1);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            overflow-x: auto;
        }
        
        .code-example pre {
            margin: 0;
            color: var(--text-primary);
            font-family: 'Courier New', monospace;
        }
        
        .breadcrumb {
            padding: 10px 0;
            margin-bottom: 20px;
        }
        
        .breadcrumb a {
            color: var(--text-accent);
            text-decoration: none;
        }
        
        .breadcrumb a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- パンくずリスト -->
        <div class="breadcrumb">
            <a href="../index.html">🏠 ホーム</a> / <span>ChromeDriver</span>
        </div>

        <!-- Header -->
        <header>
            <h1 class="main-title">
                <span class="emoji">🔵</span>
                ChromeDriver クラス
                <span class="emoji">🔵</span>
            </h1>
            <p class="subtitle">Google Chromeブラウザを自動操作するための強力なツール 🚀</p>
            
            <!-- Dark Mode Toggle -->
            <div class="theme-toggle">
                <button id="themeToggle" class="theme-btn">
                    <span class="theme-icon">🌙</span>
                    <span class="theme-text">ダークモード</span>
                </button>
            </div>
        </header>

        <!-- Search Box -->
        <div class="search-container">
            <div class="search-box">
                <span class="search-icon">🔍</span>
                <input type="text" id="searchInput" placeholder="メソッド名を検索..." />
            </div>
        </div>

        <!-- 概要 -->
        <section class="method-section">
            <h2 class="section-title">
                <span class="icon">📖</span> 概要
            </h2>
            <p>ChromeDriverクラスは、WebDriverクラスを継承し、Google Chromeブラウザを自動操作するための専用機能を提供します。</p>
            
            <div class="note-card info">
                <h3>🎯 主な用途</h3>
                <ul>
                    <li>ウェブサイトの自動テスト</li>
                    <li>ウェブスクレイピング</li>
                    <li>フォームの自動入力</li>
                    <li>定期的なウェブサイト監視</li>
                </ul>
            </div>
        </section>

        <!-- 初期化・接続メソッド -->
        <section class="method-section" data-searchable="初期化 接続 Constructor">
            <h2 class="section-title">
                <span class="icon">🚀</span> 初期化・接続関連
            </h2>

            <div class="method-card">
                <div class="method-name">ChromeDriver() - コンストラクタ</div>
                <p>ChromeDriverインスタンスを作成し、Chromeブラウザを起動します。</p>
                
                <div class="code-example">
                    <pre><code># ChromeDriverのインスタンスを作成
$driver = [ChromeDriver]::new()

# ブラウザが自動的に起動され、デバッグモードが有効になります</code></pre>
                </div>
                
                <div class="note-card warning">
                    <h4>⚠️ 注意事項</h4>
                    <ul>
                        <li>Chromeがインストールされている必要があります</li>
                        <li>初期化に失敗した場合、エラーコード3001が記録されます</li>
                        <li>一時的なユーザープロファイルが作成されます</li>
                    </ul>
                </div>
            </div>

            <div class="method-card">
                <div class="method-name">GetChromeExecutablePath() - Chrome実行パス取得</div>
                <p>システムにインストールされているChromeの実行ファイルパスを自動的に検出します。</p>
                
                <div class="code-example">
                    <pre><code># 内部的に呼び出されるメソッド（通常は直接呼び出さない）
# レジストリや一般的なインストール先から自動検出</code></pre>
                </div>
            </div>

            <div class="method-card">
                <div class="method-name">GetUserDataDirectory() - ユーザーデータディレクトリ取得</div>
                <p>Chrome用の一時的なユーザーデータディレクトリを作成します。</p>
                
                <div class="code-example">
                    <pre><code># 内部的に呼び出されるメソッド
# C:\temp\ChromeDriver_UserData_[ランダム番号] が作成されます</code></pre>
                </div>
            </div>
        </section>

        <!-- 設定・初期化メソッド -->
        <section class="method-section" data-searchable="設定 デバッグ">
            <h2 class="section-title">
                <span class="icon">⚙️</span> 設定・初期化関連
            </h2>

            <div class="method-card">
                <div class="method-name">EnableDebugMode() - デバッグモード有効化</div>
                <p>Chromeのデバッグモードを有効にし、開発者ツールの機能を利用可能にします。</p>
                
                <div class="code-example">
                    <pre><code># デバッグモードは自動的に有効化されますが、
# 必要に応じて再度有効化できます
$driver.EnableDebugMode()
Write-Host "デバッグモードが有効になりました"</code></pre>
                </div>
            </div>
        </section>

        <!-- WebDriver継承メソッド -->
        <section class="method-section" data-searchable="ナビゲーション 操作">
            <h2 class="section-title">
                <span class="icon">🌐</span> WebDriver継承メソッド（主要な操作）
            </h2>

            <div class="method-card">
                <div class="method-name">Navigate([string]$url) - ページ遷移</div>
                <p>指定したURLにページを遷移させます。</p>
                
                <div class="code-example">
                    <pre><code># Googleのホームページを開く
$driver.Navigate("https://www.google.com")

# ローカルファイルも開けます
$driver.Navigate("file:///C:/test/index.html")</code></pre>
                </div>
            </div>

            <div class="method-card">
                <div class="method-name">FindElement([string]$selector) - 要素の検索</div>
                <p>CSSセレクタを使用して要素を検索します。</p>
                
                <div class="code-example">
                    <pre><code># 検索ボックスを見つける
$searchBox = $driver.FindElement("input[name='q']")

# IDで要素を検索
$button = $driver.FindElement("#submit-button")

# クラス名で要素を検索
$element = $driver.FindElement(".container")</code></pre>
                </div>
            </div>

            <div class="method-card">
                <div class="method-name">Click([string]$selector) - 要素をクリック</div>
                <p>指定した要素をクリックします。</p>
                
                <div class="code-example">
                    <pre><code># 検索ボタンをクリック
$driver.Click("input[type='submit']")

# リンクをクリック
$driver.Click("a[href='/about']")</code></pre>
                </div>
            </div>

            <div class="method-card">
                <div class="method-name">SetText([string]$selector, [string]$text) - テキスト入力</div>
                <p>指定した要素にテキストを入力します。</p>
                
                <div class="code-example">
                    <pre><code># 検索ボックスにテキストを入力
$driver.SetText("input[name='q']", "PowerShell ChromeDriver")

# フォームに情報を入力
$driver.SetText("#username", "user@example.com")
$driver.SetText("#password", "SecurePassword123")</code></pre>
                </div>
            </div>

            <div class="method-card">
                <div class="method-name">TakeScreenshot([string]$filePath) - スクリーンショット</div>
                <p>現在のページのスクリーンショットを保存します。</p>
                
                <div class="code-example">
                    <pre><code># スクリーンショットを保存
$driver.TakeScreenshot("C:\Screenshots\page.png")

# タイムスタンプ付きで保存
$timestamp = Get-Date -Format "yyyyMMdd_HHmmss"
$driver.TakeScreenshot("C:\Screenshots\screenshot_$timestamp.png")</code></pre>
                </div>
            </div>
        </section>

        <!-- 実践的な使用例 -->
        <section class="method-section">
            <h2 class="section-title">
                <span class="icon">💡</span> 実践的な使用例
            </h2>

            <div class="method-card">
                <div class="method-name">例1: Google検索の自動化</div>
                
                <div class="code-example">
                    <pre><code># ChromeDriverを初期化
$driver = [ChromeDriver]::new()

try {
    # Googleを開く
    $driver.Navigate("https://www.google.com")
    
    # 検索ボックスにテキストを入力
    $driver.SetText("input[name='q']", "PowerShell automation")
    
    # Enterキーを押して検索
    $driver.SendKeys("input[name='q']", "{ENTER}")
    
    # 結果が表示されるまで待機
    Start-Sleep -Seconds 2
    
    # スクリーンショットを保存
    $driver.TakeScreenshot("C:\temp\search_results.png")
    
    Write-Host "検索が完了しました！"
}
finally {
    # リソースを解放
    $driver.Dispose()
}</code></pre>
                </div>
            </div>

            <div class="method-card">
                <div class="method-name">例2: フォームの自動入力</div>
                
                <div class="code-example">
                    <pre><code># ChromeDriverを初期化
$driver = [ChromeDriver]::new()

try {
    # フォームページを開く
    $driver.Navigate("https://example.com/form")
    
    # フォームに情報を入力
    $driver.SetText("#firstName", "太郎")
    $driver.SetText("#lastName", "田中")
    $driver.SetText("#email", "taro@example.com")
    
    # ドロップダウンを選択
    $driver.SelectByText("#country", "日本")
    
    # チェックボックスをチェック
    $driver.SetCheckbox("#newsletter", $true)
    
    # 送信ボタンをクリック
    $driver.Click("#submit")
    
    Write-Host "フォームを送信しました！"
}
finally {
    $driver.Dispose()
}</code></pre>
                </div>
            </div>
        </section>

        <!-- エラーハンドリング -->
        <section class="method-section" data-searchable="エラー処理 クリーンアップ">
            <h2 class="section-title">
                <span class="icon">⚠️</span> エラーハンドリング・クリーンアップ
            </h2>

            <div class="method-card">
                <div class="method-name">CleanupOnInitializationFailure() - 初期化失敗時のクリーンアップ</div>
                <p>初期化に失敗した場合、リソースを適切にクリーンアップします。</p>
                
                <div class="code-example">
                    <pre><code># このメソッドは内部的に自動呼び出しされます
# WebSocket接続のクローズ
# ブラウザプロセスの終了
# 一時ディレクトリの削除</code></pre>
                </div>
            </div>

            <div class="method-card">
                <div class="method-name">Dispose() - リソース解放</div>
                <p>ChromeDriverのリソースを解放し、ブラウザを終了します。</p>
                
                <div class="code-example">
                    <pre><code># 使用後は必ずDisposeを呼び出す
$driver = [ChromeDriver]::new()

try {
    # 処理を実行
    $driver.Navigate("https://example.com")
    # ...
}
finally {
    # リソースを確実に解放
    $driver.Dispose()
}</code></pre>
                </div>
                
                <div class="note-card warning">
                    <h4>🔥 重要</h4>
                    <ul>
                        <li>Dispose()を呼ばないとブラウザプロセスが残り続けます</li>
                        <li>try-finallyブロックで確実に呼び出すことを推奨</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- エラーコード一覧 -->
        <section class="method-section">
            <h2 class="section-title">
                <span class="icon">🚨</span> ChromeDriver固有のエラーコード
            </h2>
            
            <div class="error-range-card">
                <table class="error-table">
                    <tr>
                        <td class="range">3001</td>
                        <td>ChromeDriver初期化エラー</td>
                    </tr>
                    <tr>
                        <td class="range">3002</td>
                        <td>Chrome実行ファイルパス取得エラー</td>
                    </tr>
                    <tr>
                        <td class="range">3003</td>
                        <td>ユーザーデータディレクトリ作成エラー</td>
                    </tr>
                    <tr>
                        <td class="range">3004</td>
                        <td>デバッグモード有効化エラー</td>
                    </tr>
                    <tr>
                        <td class="range">3005</td>
                        <td>ChromeDriver Disposeエラー</td>
                    </tr>
                </table>
            </div>
        </section>

        <!-- エラーコード一覧 -->
        <section class="method-section">
            <h2 class="section-title">
                <span class="icon">🚨</span> ChromeDriver固有のエラーコード
            </h2>
            
            <div class="error-range-card">
                <p>ChromeDriverクラスでは、ChromeError_0001からChromeError_0006までのエラーコードが使用されます。</p>
                <table class="error-table">
                    <tr>
                        <td class="range">ChromeError_0001</td>
                        <td>ChromeDriver初期化エラー</td>
                    </tr>
                    <tr>
                        <td class="range">ChromeError_0002</td>
                        <td>Chrome実行ファイルパス取得エラー</td>
                    </tr>
                    <tr>
                        <td class="range">ChromeError_0003</td>
                        <td>ユーザーデータディレクトリ作成エラー</td>
                    </tr>
                    <tr>
                        <td class="range">ChromeError_0004</td>
                        <td>デバッグモード有効化エラー</td>
                    </tr>
                    <tr>
                        <td class="range">ChromeError_0005</td>
                        <td>ChromeDriver Disposeエラー</td>
                    </tr>
                    <tr>
                        <td class="range">ChromeError_0006</td>
                        <td>初期化失敗時のクリーンアップエラー</td>
                    </tr>
                </table>
            </div>
        </section>

        <!-- トラブルシューティング -->
        <section class="method-section">
            <h2 class="section-title">
                <span class="icon">🔧</span> トラブルシューティング
            </h2>
            
            <div class="note-card warning">
                <h3>よくある問題と解決方法</h3>
                <ul>
                    <li><strong>Chromeが起動しない</strong>: Chromeが正しくインストールされているか確認</li>
                    <li><strong>ポート9222が使用中</strong>: 他のChromeインスタンスを終了</li>
                    <li><strong>要素が見つからない</strong>: WaitForElement()を使用して要素の表示を待機</li>
                    <li><strong>スクリーンショットが真っ白</strong>: ページの読み込み完了を待機</li>
                </ul>
            </div>
        </section>

        <!-- Footer -->
        <footer>
            <div class="footer-content">
                <p><a href="../index.html">← ドキュメントホームに戻る</a></p>
                <p class="version">ChromeDriver Documentation v1.0.0</p>
            </div>
        </footer>
    </div>

    <script src="../js/script.js"></script>
</body>
</html>