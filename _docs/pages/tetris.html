<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ†ãƒˆãƒªã‚¹ - PowerShell ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</title>
    <link rel="stylesheet" href="../css/styles.css">
    <style>
        .game-container {
            text-align: center;
            padding: 20px;
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .start-screen {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            color: #333;
        }
        
        .start-screen h2 {
            font-size: 2.5em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            color: #00b894;
        }
        
        .instructions {
            background: rgba(255,255,255,0.3);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .start-button {
            background: linear-gradient(45deg, #00b894, #00cec9);
            border: none;
            color: white;
            padding: 15px 40px;
            font-size: 1.2em;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        
        .start-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.3);
        }
        
        .game-area {
            display: none;
            justify-content: center;
            gap: 30px;
            align-items: flex-start;
        }
        
        .game-canvas {
            border: 3px solid #a8edea;
            border-radius: 15px;
            background: linear-gradient(180deg, #2c3e50 0%, #34495e 100%);
        }
        
        .game-info {
            text-align: left;
            background: linear-gradient(135deg, #a8edea, #fed6e3);
            padding: 20px;
            border-radius: 15px;
            color: #333;
            min-width: 200px;
        }
        
        .next-piece {
            background: rgba(255,255,255,0.3);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
        }
        
        .score-display {
            background: rgba(255,255,255,0.3);
            padding: 10px;
            border-radius: 10px;
            margin: 10px 0;
            font-weight: bold;
        }
        
        .game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(168,237,234,0.95);
            color: #333;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            display: none;
            backdrop-filter: blur(10px);
        }
        
        .restart-button {
            background: linear-gradient(45deg, #00b894, #00cec9);
            border: none;
            color: white;
            padding: 12px 30px;
            font-size: 1.1em;
            border-radius: 25px;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
        }
        
        .restart-button:hover {
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <div class="container">
        <nav class="breadcrumb">
            <a href="../index.html">ãƒ›ãƒ¼ãƒ </a> &gt; ãƒ†ãƒˆãƒªã‚¹
        </nav>
        
        <header>
            <h1>ğŸ§© ãƒ†ãƒˆãƒªã‚¹</h1>
            <p>ãƒ–ãƒ­ãƒƒã‚¯ã‚’çµ„ã¿åˆã‚ã›ã¦ãƒ©ã‚¤ãƒ³ã‚’æ¶ˆãã†ï¼</p>
            <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ™</button>
        </header>
        
        <div class="search-container">
            <input type="text" id="searchInput" placeholder="ã‚²ãƒ¼ãƒ å†…ã‚’æ¤œç´¢..." onkeyup="filterContent()">
        </div>
        
        <div class="game-container">
            <div class="start-screen" id="startScreen">
                <h2>ğŸŒŸ ãƒ†ãƒˆãƒªã‚¹ ğŸŒŸ</h2>
                <div class="instructions">
                    <h3>ğŸ® æ“ä½œæ–¹æ³•</h3>
                    <p><strong>â† â†’</strong> ã‚­ãƒ¼: ãƒ–ãƒ­ãƒƒã‚¯ã‚’å·¦å³ã«ç§»å‹•</p>
                    <p><strong>â†“</strong> ã‚­ãƒ¼: ãƒ–ãƒ­ãƒƒã‚¯ã‚’ä¸‹ã«ç§»å‹•ï¼ˆã‚½ãƒ•ãƒˆãƒ‰ãƒ­ãƒƒãƒ—ï¼‰</p>
                    <p><strong>â†‘</strong> ã‚­ãƒ¼: ãƒ–ãƒ­ãƒƒã‚¯ã‚’å›è»¢</p>
                    <p><strong>ã‚¹ãƒšãƒ¼ã‚¹</strong> ã‚­ãƒ¼: ãƒ–ãƒ­ãƒƒã‚¯ã‚’ä¸€æ°—ã«ä¸‹ã«ç§»å‹•ï¼ˆãƒãƒ¼ãƒ‰ãƒ‰ãƒ­ãƒƒãƒ—ï¼‰</p>
                    <p><strong>P</strong> ã‚­ãƒ¼: ä¸€æ™‚åœæ­¢/å†é–‹</p>
                </div>
                <div class="instructions">
                    <h3>ğŸ¯ ã‚²ãƒ¼ãƒ ã®ç›®çš„</h3>
                    <p>è½ã¡ã¦ãã‚‹ãƒ–ãƒ­ãƒƒã‚¯ã‚’çµ„ã¿åˆã‚ã›ã¦ã€æ¨ªä¸€åˆ—ã‚’å®Œæˆã•ã›ã‚ˆã†ï¼</p>
                    <p>ãƒ©ã‚¤ãƒ³ãŒå®Œæˆã™ã‚‹ã¨æ¶ˆãˆã¦ã€ã‚¹ã‚³ã‚¢ãŒåŠ ç®—ã•ã‚Œã¾ã™ã€‚</p>
                </div>
                <button class="start-button" onclick="startGame()">ã‚²ãƒ¼ãƒ ã‚¹ã‚¿ãƒ¼ãƒˆï¼ ğŸ§©</button>
            </div>
            
            <div class="game-area" id="gameArea">
                <canvas id="gameCanvas" class="game-canvas" width="300" height="600"></canvas>
                
                <div class="game-info">
                    <h3>ğŸ“Š ã‚²ãƒ¼ãƒ æƒ…å ±</h3>
                    <div class="score-display">ã‚¹ã‚³ã‚¢: <span id="score">0</span></div>
                    <div class="score-display">ãƒ©ã‚¤ãƒ³: <span id="lines">0</span></div>
                    <div class="score-display">ãƒ¬ãƒ™ãƒ«: <span id="level">1</span></div>
                    
                    <div class="next-piece">
                        <h4>æ¬¡ã®ãƒ”ãƒ¼ã‚¹</h4>
                        <canvas id="nextCanvas" width="120" height="120"></canvas>
                    </div>
                    
                    <div class="score-display">
                        <h4>æ“ä½œèª¬æ˜</h4>
                        <p>â† â†’ : ç§»å‹•</p>
                        <p>â†‘ : å›è»¢</p>
                        <p>â†“ : ã‚½ãƒ•ãƒˆãƒ‰ãƒ­ãƒƒãƒ—</p>
                        <p>ã‚¹ãƒšãƒ¼ã‚¹ : ãƒãƒ¼ãƒ‰ãƒ‰ãƒ­ãƒƒãƒ—</p>
                    </div>
                </div>
            </div>
            
            <div class="game-over" id="gameOver">
                <h2>ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼</h2>
                <p>æœ€çµ‚ã‚¹ã‚³ã‚¢: <span id="finalScore">0</span></p>
                <p>æ¶ˆå»ãƒ©ã‚¤ãƒ³: <span id="finalLines">0</span></p>
                <button class="restart-button" onclick="restartGame()">ã‚‚ã†ä¸€åº¦ãƒ—ãƒ¬ã‚¤</button>
                <button class="restart-button" onclick="showStartScreen()">ã‚¿ã‚¤ãƒˆãƒ«ã«æˆ»ã‚‹</button>
            </div>
        </div>
    </div>
    
    <footer>
        <p><a href="../index.html">ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</a> | PowerShell ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ v1.0</p>
    </footer>
    
    <script src="../js/script.js"></script>
    <script>
        // ã‚²ãƒ¼ãƒ å¤‰æ•°
        let canvas, ctx, nextCanvas, nextCtx;
        let gameRunning = false;
        let gamePaused = false;
        let score = 0;
        let lines = 0;
        let level = 1;
        let dropTime = 0;
        let dropInterval = 1000;
        
        // ã‚²ãƒ¼ãƒ ãƒœãƒ¼ãƒ‰
        const BOARD_WIDTH = 10;
        const BOARD_HEIGHT = 20;
        let board = [];
        
        // ãƒ†ãƒˆãƒ­ãƒŸãƒï¼ˆãƒ†ãƒˆãƒªã‚¹ã®ãƒ”ãƒ¼ã‚¹ï¼‰
        const PIECES = [
            // Iãƒ”ãƒ¼ã‚¹
            [[1, 1, 1, 1]],
            // Oãƒ”ãƒ¼ã‚¹
            [[1, 1], [1, 1]],
            // Tãƒ”ãƒ¼ã‚¹
            [[0, 1, 0], [1, 1, 1]],
            // Sãƒ”ãƒ¼ã‚¹
            [[0, 1, 1], [1, 1, 0]],
            // Zãƒ”ãƒ¼ã‚¹
            [[1, 1, 0], [0, 1, 1]],
            // Jãƒ”ãƒ¼ã‚¹
            [[1, 0, 0], [1, 1, 1]],
            // Lãƒ”ãƒ¼ã‚¹
            [[0, 0, 1], [1, 1, 1]]
        ];
        
        const PIECE_COLORS = [
            '#00f5ff', // I - ã‚·ã‚¢ãƒ³
            '#ffff00', // O - ã‚¤ã‚¨ãƒ­ãƒ¼
            '#800080', // T - ãƒã‚¼ãƒ³ã‚¿
            '#00ff00', // S - ã‚°ãƒªãƒ¼ãƒ³
            '#ff0000', // Z - ãƒ¬ãƒƒãƒ‰
            '#0000ff', // J - ãƒ–ãƒ«ãƒ¼
            '#ffa500'  // L - ã‚ªãƒ¬ãƒ³ã‚¸
        ];
        
        // ç¾åœ¨ã®ãƒ”ãƒ¼ã‚¹
        let currentPiece = null;
        let nextPiece = null;
        let currentPieceColor = '';
        
        // ã‚­ãƒ¼å…¥åŠ›
        let keys = {};
        
        // ã‚²ãƒ¼ãƒ é–‹å§‹
        function startGame() {
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('gameArea').style.display = 'flex';
            
            canvas = document.getElementById('gameCanvas');
            ctx = canvas.getContext('2d');
            nextCanvas = document.getElementById('nextCanvas');
            nextCtx = nextCanvas.getContext('2d');
            
            initGame();
            gameLoop();
        }
        
        // ã‚²ãƒ¼ãƒ åˆæœŸåŒ–
        function initGame() {
            gameRunning = true;
            score = 0;
            lines = 0;
            level = 1;
            dropInterval = 1000;
            
            // ãƒœãƒ¼ãƒ‰åˆæœŸåŒ–
            board = [];
            for (let y = 0; y < BOARD_HEIGHT; y++) {
                board[y] = [];
                for (let x = 0; x < BOARD_WIDTH; x++) {
                    board[y][x] = 0;
                }
            }
            
            // æœ€åˆã®ãƒ”ãƒ¼ã‚¹ç”Ÿæˆ
            nextPiece = generateRandomPiece();
            spawnNewPiece();
            
            // ã‚­ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆè¨­å®š
            document.addEventListener('keydown', handleKeyDown);
            document.addEventListener('keyup', handleKeyUp);
        }
        
        // ãƒ©ãƒ³ãƒ€ãƒ ãƒ”ãƒ¼ã‚¹ç”Ÿæˆ
        function generateRandomPiece() {
            const pieceIndex = Math.floor(Math.random() * PIECES.length);
            return {
                shape: PIECES[pieceIndex],
                color: PIECE_COLORS[pieceIndex],
                x: Math.floor(BOARD_WIDTH / 2) - Math.floor(PIECES[pieceIndex][0].length / 2),
                y: 0
            };
        }
        
        // æ–°ã—ã„ãƒ”ãƒ¼ã‚¹ç”Ÿæˆ
        function spawnNewPiece() {
            currentPiece = nextPiece;
            nextPiece = generateRandomPiece();
            currentPieceColor = currentPiece.color;
            
            // ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼åˆ¤å®š
            if (isCollision(currentPiece)) {
                gameOver();
            }
        }
        
        // è¡çªåˆ¤å®š
        function isCollision(piece) {
            for (let y = 0; y < piece.shape.length; y++) {
                for (let x = 0; x < piece.shape[y].length; x++) {
                    if (piece.shape[y][x]) {
                        let boardX = piece.x + x;
                        let boardY = piece.y + y;
                        
                        if (boardX < 0 || boardX >= BOARD_WIDTH || 
                            boardY >= BOARD_HEIGHT || 
                            (boardY >= 0 && board[boardY][boardX])) {
                            return true;
                        }
                    }
                }
            }
            return false;
        }
        
        // ãƒ”ãƒ¼ã‚¹ã‚’ãƒœãƒ¼ãƒ‰ã«å›ºå®š
        function placePiece() {
            for (let y = 0; y < currentPiece.shape.length; y++) {
                for (let x = 0; x < currentPiece.shape[y].length; x++) {
                    if (currentPiece.shape[y][x]) {
                        let boardX = currentPiece.x + x;
                        let boardY = currentPiece.y + y;
                        if (boardY >= 0) {
                            board[boardY][boardX] = currentPieceColor;
                        }
                    }
                }
            }
            
            // ãƒ©ã‚¤ãƒ³æ¶ˆå»ãƒã‚§ãƒƒã‚¯
            checkLines();
            
            // æ–°ã—ã„ãƒ”ãƒ¼ã‚¹ç”Ÿæˆ
            spawnNewPiece();
        }
        
        // ãƒ©ã‚¤ãƒ³æ¶ˆå»ãƒã‚§ãƒƒã‚¯
        function checkLines() {
            let linesCleared = 0;
            
            for (let y = BOARD_HEIGHT - 1; y >= 0; y--) {
                if (board[y].every(cell => cell !== 0)) {
                    // ãƒ©ã‚¤ãƒ³ã‚’å‰Šé™¤
                    board.splice(y, 1);
                    board.unshift(new Array(BOARD_WIDTH).fill(0));
                    linesCleared++;
                    y++; // åŒã˜è¡Œã‚’ã‚‚ã†ä¸€åº¦ãƒã‚§ãƒƒã‚¯
                }
            }
            
            if (linesCleared > 0) {
                lines += linesCleared;
                score += linesCleared * 100 * level;
                
                // ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—
                if (lines >= level * 10) {
                    level++;
                    dropInterval = Math.max(100, dropInterval - 100);
                }
            }
        }
        
        // ã‚­ãƒ¼æŠ¼ä¸‹å‡¦ç†
        function handleKeyDown(e) {
            keys[e.key] = true;
            
            if (e.key === 'p' || e.key === 'P') {
                togglePause();
            }
        }
        
        // ã‚­ãƒ¼é›¢ä¸Šå‡¦ç†
        function handleKeyUp(e) {
            keys[e.key] = false;
        }
        
        // ä¸€æ™‚åœæ­¢åˆ‡ã‚Šæ›¿ãˆ
        function togglePause() {
            gamePaused = !gamePaused;
        }
        
        // ã‚²ãƒ¼ãƒ ãƒ«ãƒ¼ãƒ—
        function gameLoop() {
            if (!gameRunning) return;
            
            if (!gamePaused) {
                updateGame();
            }
            
            drawGame();
            requestAnimationFrame(gameLoop);
        }
        
        // ã‚²ãƒ¼ãƒ æ›´æ–°
        function updateGame() {
            // ãƒ”ãƒ¼ã‚¹ç§»å‹•
            if (keys['ArrowLeft']) {
                movePiece(-1, 0);
            }
            if (keys['ArrowRight']) {
                movePiece(1, 0);
            }
            if (keys['ArrowDown']) {
                movePiece(0, 1);
            }
            if (keys['ArrowUp']) {
                rotatePiece();
            }
            if (keys[' ']) {
                hardDrop();
            }
            
            // è‡ªå‹•è½ä¸‹
            dropTime += 16; // ç´„60FPS
            if (dropTime >= dropInterval) {
                dropTime = 0;
                if (!movePiece(0, 1)) {
                    placePiece();
                }
            }
        }
        
        // ãƒ”ãƒ¼ã‚¹ç§»å‹•
        function movePiece(dx, dy) {
            let newPiece = {
                ...currentPiece,
                x: currentPiece.x + dx,
                y: currentPiece.y + dy
            };
            
            if (!isCollision(newPiece)) {
                currentPiece = newPiece;
                return true;
            }
            return false;
        }
        
        // ãƒ”ãƒ¼ã‚¹å›è»¢
        function rotatePiece() {
            let rotated = [];
            let shape = currentPiece.shape;
            
            // 90åº¦å›è»¢
            for (let x = 0; x < shape[0].length; x++) {
                rotated[x] = [];
                for (let y = shape.length - 1; y >= 0; y--) {
                    rotated[x][shape.length - 1 - y] = shape[y][x];
                }
            }
            
            let newPiece = {
                ...currentPiece,
                shape: rotated
            };
            
            if (!isCollision(newPiece)) {
                currentPiece = newPiece;
            }
        }
        
        // ãƒãƒ¼ãƒ‰ãƒ‰ãƒ­ãƒƒãƒ—
        function hardDrop() {
            while (movePiece(0, 1)) {
                score += 2;
            }
        }
        
        // ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼
        function gameOver() {
            gameRunning = false;
            document.getElementById('finalScore').textContent = score;
            document.getElementById('finalLines').textContent = lines;
            document.getElementById('gameOver').style.display = 'block';
        }
        
        // ã‚²ãƒ¼ãƒ æç”»
        function drawGame() {
            // ãƒœãƒ¼ãƒ‰æç”»
            drawBoard();
            
            // ç¾åœ¨ã®ãƒ”ãƒ¼ã‚¹æç”»
            drawPiece(currentPiece, currentPieceColor);
            
            // æ¬¡ã®ãƒ”ãƒ¼ã‚¹æç”»
            drawNextPiece();
            
            // UIæ›´æ–°
            document.getElementById('score').textContent = score;
            document.getElementById('lines').textContent = lines;
            document.getElementById('level').textContent = level;
        }
        
        // ãƒœãƒ¼ãƒ‰æç”»
        function drawBoard() {
            ctx.fillStyle = '#2c3e50';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // ã‚°ãƒªãƒƒãƒ‰æç”»
            ctx.strokeStyle = '#34495e';
            ctx.lineWidth = 1;
            
            for (let x = 0; x <= BOARD_WIDTH; x++) {
                ctx.beginPath();
                ctx.moveTo(x * 30, 0);
                ctx.lineTo(x * 30, canvas.height);
                ctx.stroke();
            }
            
            for (let y = 0; y <= BOARD_HEIGHT; y++) {
                ctx.beginPath();
                ctx.moveTo(0, y * 30);
                ctx.lineTo(canvas.width, y * 30);
                ctx.stroke();
            }
            
            // é…ç½®æ¸ˆã¿ãƒ–ãƒ­ãƒƒã‚¯æç”»
            for (let y = 0; y < BOARD_HEIGHT; y++) {
                for (let x = 0; x < BOARD_WIDTH; x++) {
                    if (board[y][x]) {
                        drawBlock(x, y, board[y][x]);
                    }
                }
            }
        }
        
        // ãƒ–ãƒ­ãƒƒã‚¯æç”»
        function drawBlock(x, y, color) {
            ctx.fillStyle = color;
            ctx.fillRect(x * 30 + 1, y * 30 + 1, 28, 28);
            
            // ãƒã‚¤ãƒ©ã‚¤ãƒˆåŠ¹æœ
            ctx.fillStyle = 'rgba(255,255,255,0.3)';
            ctx.fillRect(x * 30 + 1, y * 30 + 1, 28, 4);
            ctx.fillRect(x * 30 + 1, y * 30 + 1, 4, 28);
        }
        
        // ãƒ”ãƒ¼ã‚¹æç”»
        function drawPiece(piece, color) {
            for (let y = 0; y < piece.shape.length; y++) {
                for (let x = 0; x < piece.shape[y].length; x++) {
                    if (piece.shape[y][x]) {
                        let boardX = piece.x + x;
                        let boardY = piece.y + y;
                        
                        if (boardY >= 0) {
                            ctx.fillStyle = color;
                            ctx.fillRect(boardX * 30 + 1, boardY * 30 + 1, 28, 28);
                            
                            // ãƒã‚¤ãƒ©ã‚¤ãƒˆåŠ¹æœ
                            ctx.fillStyle = 'rgba(255,255,255,0.3)';
                            ctx.fillRect(boardX * 30 + 1, boardY * 30 + 1, 28, 4);
                            ctx.fillRect(boardX * 30 + 1, boardY * 30 + 1, 4, 28);
                        }
                    }
                }
            }
        }
        
        // æ¬¡ã®ãƒ”ãƒ¼ã‚¹æç”»
        function drawNextPiece() {
            nextCtx.fillStyle = '#2c3e50';
            nextCtx.fillRect(0, 0, nextCanvas.width, nextCanvas.height);
            
            let offsetX = (nextCanvas.width - nextPiece.shape[0].length * 20) / 2;
            let offsetY = (nextCanvas.height - nextPiece.shape.length * 20) / 2;
            
            for (let y = 0; y < nextPiece.shape.length; y++) {
                for (let x = 0; x < nextPiece.shape[y].length; x++) {
                    if (nextPiece.shape[y][x]) {
                        nextCtx.fillStyle = nextPiece.color;
                        nextCtx.fillRect(offsetX + x * 20, offsetY + y * 20, 18, 18);
                    }
                }
            }
        }
        
        // ã‚²ãƒ¼ãƒ å†é–‹
        function restartGame() {
            document.getElementById('gameOver').style.display = 'none';
            initGame();
        }
        
        // ã‚¹ã‚¿ãƒ¼ãƒˆç”»é¢è¡¨ç¤º
        function showStartScreen() {
            document.getElementById('gameOver').style.display = 'none';
            document.getElementById('startScreen').style.display = 'block';
            document.getElementById('gameArea').style.display = 'none';
            
            gameRunning = false;
        }
        
        // æ¤œç´¢æ©Ÿèƒ½
        function filterContent() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            // ã‚²ãƒ¼ãƒ å†…ã®æ¤œç´¢æ©Ÿèƒ½ï¼ˆå¿…è¦ã«å¿œã˜ã¦å®Ÿè£…ï¼‰
        }
    </script>
</body>
</html>
