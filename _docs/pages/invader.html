<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¤ãƒ³ãƒ™ãƒ¼ãƒ€ãƒ¼ã‚²ãƒ¼ãƒ  - PowerShell ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</title>
    <link rel="stylesheet" href="../css/styles.css">
    <style>
        .game-container {
            text-align: center;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .start-screen {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            color: white;
        }
        
        .start-screen h2 {
            font-size: 2.5em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .instructions {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            backdrop-filter: blur(10px);
        }
        
        .start-button {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            border: none;
            color: white;
            padding: 15px 40px;
            font-size: 1.2em;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        
        .start-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.3);
        }
        
        .game-canvas {
            border: 3px solid #667eea;
            border-radius: 15px;
            background: linear-gradient(180deg, #0c0c0c 0%, #1a1a2e 100%);
            display: none;
        }
        
        .game-ui {
            display: none;
            margin-top: 20px;
        }
        
        .score-display {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.2em;
            font-weight: bold;
            margin: 10px;
            display: inline-block;
        }
        
        .game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.9);
            color: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            display: none;
        }
        
        .restart-button {
            background: linear-gradient(45deg, #00b894, #00cec9);
            border: none;
            color: white;
            padding: 12px 30px;
            font-size: 1.1em;
            border-radius: 25px;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
        }
        
        .restart-button:hover {
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <div class="container">
        <nav class="breadcrumb">
            <a href="../index.html">ãƒ›ãƒ¼ãƒ </a> &gt; ã‚¤ãƒ³ãƒ™ãƒ¼ãƒ€ãƒ¼ã‚²ãƒ¼ãƒ 
        </nav>
        
        <header>
            <h1>ğŸš€ ã‚¤ãƒ³ãƒ™ãƒ¼ãƒ€ãƒ¼ã‚²ãƒ¼ãƒ </h1>
            <p>ã‚¯ãƒ©ã‚·ãƒƒã‚¯ãªã‚¹ãƒšãƒ¼ã‚¹ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚²ãƒ¼ãƒ ã§éŠã¼ã†ï¼</p>
            <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ™</button>
        </header>
        
        <div class="search-container">
            <input type="text" id="searchInput" placeholder="ã‚²ãƒ¼ãƒ å†…ã‚’æ¤œç´¢..." onkeyup="filterContent()">
        </div>
        
        <div class="game-container">
            <div class="start-screen" id="startScreen">
                <h2>ğŸŒŸ ã‚¤ãƒ³ãƒ™ãƒ¼ãƒ€ãƒ¼ã‚²ãƒ¼ãƒ  ğŸŒŸ</h2>
                <div class="instructions">
                    <h3>ğŸ® æ“ä½œæ–¹æ³•</h3>
                    <p><strong>â† â†’</strong> ã‚­ãƒ¼: ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’å·¦å³ã«ç§»å‹•</p>
                    <p><strong>ã‚¹ãƒšãƒ¼ã‚¹</strong> ã‚­ãƒ¼: å¼¾ã‚’ç™ºå°„</p>
                    <p><strong>P</strong> ã‚­ãƒ¼: ä¸€æ™‚åœæ­¢/å†é–‹</p>
                </div>
                <div class="instructions">
                    <h3>ğŸ¯ ã‚²ãƒ¼ãƒ ã®ç›®çš„</h3>
                    <p>å®‡å®™èˆ¹ã‚’æ“ä½œã—ã¦ã€ä¸Šã‹ã‚‰é™ã£ã¦ãã‚‹ã‚¤ãƒ³ãƒ™ãƒ¼ãƒ€ãƒ¼ã‚’å…¨ã¦å€’ãã†ï¼</p>
                    <p>ã‚¤ãƒ³ãƒ™ãƒ¼ãƒ€ãƒ¼ãŒä¸‹ã«åˆ°é”ã™ã‚‹å‰ã«å€’ã™ã“ã¨ãŒé‡è¦ã§ã™ã€‚</p>
                </div>
                <button class="start-button" onclick="startGame()">ã‚²ãƒ¼ãƒ ã‚¹ã‚¿ãƒ¼ãƒˆï¼ ğŸš€</button>
            </div>
            
            <canvas id="gameCanvas" class="game-canvas" width="800" height="600"></canvas>
            
            <div class="game-ui" id="gameUI">
                <div class="score-display">ã‚¹ã‚³ã‚¢: <span id="score">0</span></div>
                <div class="score-display">ãƒ©ã‚¤ãƒ•: <span id="lives">3</span></div>
                <div class="score-display">ãƒ¬ãƒ™ãƒ«: <span id="level">1</span></div>
            </div>
            
            <div class="game-over" id="gameOver">
                <h2>ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼</h2>
                <p>æœ€çµ‚ã‚¹ã‚³ã‚¢: <span id="finalScore">0</span></p>
                <button class="restart-button" onclick="restartGame()">ã‚‚ã†ä¸€åº¦ãƒ—ãƒ¬ã‚¤</button>
                <button class="restart-button" onclick="showStartScreen()">ã‚¿ã‚¤ãƒˆãƒ«ã«æˆ»ã‚‹</button>
            </div>
        </div>
    </div>
    
    <footer>
        <p><a href="../index.html">ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</a> | PowerShell ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ v1.0</p>
    </footer>
    
    <script src="../js/script.js"></script>
    <script>
        // ã‚²ãƒ¼ãƒ å¤‰æ•°
        let canvas, ctx;
        let gameRunning = false;
        let gamePaused = false;
        let playerHit = false; // è¢«å¼¾çŠ¶æ…‹
        let playerDestroyed = false; // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ç ´å£ŠçŠ¶æ…‹
        let score = 0;
        let lives = 3;
        let level = 1;

        // çˆ†ç™ºã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
        let explosions = [];
        let explosionParticles = [];
        
        // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼
        let player = {
            x: 400,
            y: 550,
            width: 50,
            height: 30,
            speed: 5
        };
        
        // å¼¾
        let bullets = [];
        let bulletSpeed = 7;

        // æ•µã®å¼¾
        let enemyBullets = [];
        let enemyBulletSpeed = 3;
        let enemyShootInterval = 2000; // 2ç§’ã”ã¨ã«ç™ºå°„
        let lastEnemyShootTime = 0;

        // ã‚¤ãƒ³ãƒ™ãƒ¼ãƒ€ãƒ¼
        let invaders = [];
        let invaderSpeed = 1;
        let invaderDirection = 1;
        
        // ã‚­ãƒ¼å…¥åŠ›
        let keys = {};
        
        // ã‚²ãƒ¼ãƒ é–‹å§‹
        function startGame() {
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('gameCanvas').style.display = 'block';
            document.getElementById('gameUI').style.display = 'block';
            
            canvas = document.getElementById('gameCanvas');
            ctx = canvas.getContext('2d');
            
            initGame();
            gameLoop();
        }
        
        // ã‚²ãƒ¼ãƒ åˆæœŸåŒ–
        function initGame() {
            gameRunning = true;
            playerDestroyed = false; // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ç ´å£ŠçŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
            score = 0;
            lives = 3;
            level = 1;
            
            // ã‚¤ãƒ³ãƒ™ãƒ¼ãƒ€ãƒ¼åˆæœŸåŒ–
            invaders = [];
            for (let row = 0; row < 5; row++) {
                for (let col = 0; col < 10; col++) {
                    invaders.push({
                        x: col * 70 + 50,
                        y: row * 50 + 50,
                        width: 60,
                        height: 40,
                        alive: true
                    });
                }
            }
            
            // ã‚­ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆè¨­å®š
            document.addEventListener('keydown', handleKeyDown);
            document.addEventListener('keyup', handleKeyUp);
        }
        
        // ã‚­ãƒ¼æŠ¼ä¸‹å‡¦ç†
        function handleKeyDown(e) {
            keys[e.key] = true;

            // è¢«å¼¾æ™‚ã®ã‚¹ãƒšãƒ¼ã‚¹ã‚­ãƒ¼å‡¦ç†
            if (e.key === ' ' && playerHit) {
                playerHit = false;
                gamePaused = false;
                return;
            }

            if (e.key === ' ' && gameRunning && !gamePaused) {
                shootBullet();
            }

            if (e.key === 'p' || e.key === 'P') {
                togglePause();
            }
        }
        
        // ã‚­ãƒ¼é›¢ä¸Šå‡¦ç†
        function handleKeyUp(e) {
            keys[e.key] = false;
        }
        
        // å¼¾ç™ºå°„
        function shootBullet() {
            bullets.push({
                x: player.x + player.width / 2 - 2,
                y: player.y,
                width: 4,
                height: 10
            });
        }

        // æ•µã®å¼¾ç™ºå°„
        function shootEnemyBullet() {
            // ç”Ÿãã¦ã„ã‚‹ã‚¤ãƒ³ãƒ™ãƒ¼ãƒ€ãƒ¼ã‚’å–å¾—
            let aliveInvaders = invaders.filter(inv => inv.alive);
            if (aliveInvaders.length > 0) {
                // ãƒ©ãƒ³ãƒ€ãƒ ã«ã‚¤ãƒ³ãƒ™ãƒ¼ãƒ€ãƒ¼ã‚’é¸æŠ
                let randomInvader = aliveInvaders[Math.floor(Math.random() * aliveInvaders.length)];

                enemyBullets.push({
                    x: randomInvader.x + randomInvader.width / 2 - 2,
                    y: randomInvader.y + randomInvader.height,
                    width: 4,
                    height: 10
                });
            }
        }
        
        // ä¸€æ™‚åœæ­¢åˆ‡ã‚Šæ›¿ãˆ
        function togglePause() {
            gamePaused = !gamePaused;
        }
        
        // ã‚²ãƒ¼ãƒ ãƒ«ãƒ¼ãƒ—
        function gameLoop() {
            // ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼å¾Œã‚‚çˆ†ç™ºã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’ç¶™ç¶š
            if (!gameRunning && !playerDestroyed) return;

            if (!gamePaused && gameRunning) {
                updateGame();
            }

            drawGame();
            requestAnimationFrame(gameLoop);
        }
        
        // ã‚²ãƒ¼ãƒ æ›´æ–°
        function updateGame() {
            // çˆ†ç™ºãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ã¯å¸¸ã«æ›´æ–°
            if (playerHit) {
                // è¢«å¼¾æ™‚ã¯çˆ†ç™ºã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ã¿æ›´æ–°
                return;
            }

            // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ç§»å‹•
            if (keys['ArrowLeft'] && player.x > 0) {
                player.x -= player.speed;
            }
            if (keys['ArrowRight'] && player.x < canvas.width - player.width) {
                player.x += player.speed;
            }
            
            // å¼¾ç§»å‹•
            bullets.forEach((bullet, index) => {
                bullet.y -= bulletSpeed;
                if (bullet.y < 0) {
                    bullets.splice(index, 1);
                }
            });

            // æ•µã®å¼¾ç§»å‹•
            enemyBullets.forEach((bullet, index) => {
                bullet.y += enemyBulletSpeed;
                if (bullet.y > canvas.height) {
                    enemyBullets.splice(index, 1);
                }
            });

            // æ•µã®æ”»æ’ƒ
            let currentTime = Date.now();
            if (currentTime - lastEnemyShootTime > enemyShootInterval) {
                shootEnemyBullet();
                lastEnemyShootTime = currentTime;
            }
            
            // ã‚¤ãƒ³ãƒ™ãƒ¼ãƒ€ãƒ¼ç§»å‹•
            let shouldChangeDirection = false;
            invaders.forEach(invader => {
                if (invader.alive) {
                    invader.x += invaderSpeed * invaderDirection;
                    
                    if (invader.x <= 0 || invader.x >= canvas.width - invader.width) {
                        shouldChangeDirection = true;
                    }
                }
            });
            
            if (shouldChangeDirection) {
                invaderDirection *= -1;
                invaders.forEach(invader => {
                    if (invader.alive) {
                        invader.y += 20;
                    }
                });
            }
            
            // è¡çªåˆ¤å®š
            checkCollisions();
            
            // ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼åˆ¤å®š
            checkGameOver();
        }
        
        // è¡çªåˆ¤å®š
        function checkCollisions() {
            bullets.forEach((bullet, bulletIndex) => {
                invaders.forEach((invader, invaderIndex) => {
                    if (invader.alive && 
                        bullet.x < invader.x + invader.width &&
                        bullet.x + bullet.width > invader.x &&
                        bullet.y < invader.y + invader.height &&
                        bullet.y + bullet.height > invader.y) {
                        
                        invader.alive = false;
                        bullets.splice(bulletIndex, 1);
                        score += 100;
                        
                        // ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—åˆ¤å®š
                        if (invaders.every(inv => !inv.alive)) {
                            levelUp();
                        }
                    }
                });
            });
            
            // ã‚¤ãƒ³ãƒ™ãƒ¼ãƒ€ãƒ¼ãŒä¸‹ã«åˆ°é”
            invaders.forEach(invader => {
                if (invader.alive && invader.y > player.y - 50) {
                    gameOver();
                }
            });

            // æ•µã®å¼¾ã¨ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®è¡çªåˆ¤å®š
            enemyBullets.forEach((bullet, bulletIndex) => {
                if (bullet.x < player.x + player.width &&
                    bullet.x + bullet.width > player.x &&
                    bullet.y < player.y + player.height &&
                    bullet.y + bullet.height > player.y) {

                    enemyBullets.splice(bulletIndex, 1);
                    lives--;

                    // çˆ†ç™ºã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’ç”Ÿæˆ
                    createExplosion(player.x + player.width / 2, player.y + player.height / 2);

                    if (lives <= 0) {
                        gameOver();
                    } else {
                        // ãƒ©ã‚¤ãƒ•ãŒæ®‹ã£ã¦ã„ã‚‹å ´åˆã®ã¿è¢«å¼¾çŠ¶æ…‹ã«ã—ã¦ä¸€æ™‚åœæ­¢
                        playerHit = true;
                        gamePaused = true;
                    }
                }
            });
        }
        
        // ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—
        function levelUp() {
            level++;
            invaderSpeed += 0.5;
            
            // æ–°ã—ã„ã‚¤ãƒ³ãƒ™ãƒ¼ãƒ€ãƒ¼ç”Ÿæˆ
            invaders = [];
            for (let row = 0; row < 5; row++) {
                for (let col = 0; col < 10; col++) {
                    invaders.push({
                        x: col * 70 + 50,
                        y: row * 50 + 50,
                        width: 60,
                        height: 40,
                        alive: true
                    });
                }
            }
        }
        
        // ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼åˆ¤å®š
        function checkGameOver() {
            if (lives <= 0) {
                gameOver();
            }
        }
        
        // ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼
        function gameOver() {
            gameRunning = false;
            playerDestroyed = true; // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒç ´å£Šã•ã‚ŒãŸçŠ¶æ…‹ã«ã™ã‚‹
            document.getElementById('finalScore').textContent = score;
            document.getElementById('gameOver').style.display = 'block';
        }
        
        // ã‚²ãƒ¼ãƒ æç”»
        function drawGame() {
            // èƒŒæ™¯ã‚¯ãƒªã‚¢
            ctx.fillStyle = '#0c0c0c';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // æ˜Ÿã‚’æç”»
            drawStars();
            
            // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æç”»ï¼ˆç ´å£Šã•ã‚Œã¦ã„ãªã„å ´åˆã®ã¿ï¼‰
            if (!playerDestroyed) {
                ctx.fillStyle = '#00ff88';
                ctx.fillRect(player.x, player.y, player.width, player.height);

                // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®è©³ç´°
                ctx.fillStyle = '#00cc66';
                ctx.fillRect(player.x + 5, player.y + 5, 40, 20);
            }
            
            // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®å¼¾æç”»
            ctx.fillStyle = '#ffff00';
            bullets.forEach(bullet => {
                ctx.fillRect(bullet.x, bullet.y, bullet.width, bullet.height);
            });

            // æ•µã®å¼¾æç”»
            ctx.fillStyle = '#ff3838';
            enemyBullets.forEach(bullet => {
                ctx.fillRect(bullet.x, bullet.y, bullet.width, bullet.height);
                // å¼¾ã®å…‰æ²¢åŠ¹æœ
                ctx.fillStyle = '#ff6666';
                ctx.fillRect(bullet.x + 1, bullet.y + 1, 2, 4);
            });
            
            // ã‚¤ãƒ³ãƒ™ãƒ¼ãƒ€ãƒ¼æç”»
            invaders.forEach(invader => {
                if (invader.alive) {
                    ctx.fillStyle = '#ff6b6b';
                    ctx.fillRect(invader.x, invader.y, invader.width, invader.height);
                    
                    // ã‚¤ãƒ³ãƒ™ãƒ¼ãƒ€ãƒ¼ã®è©³ç´°
                    ctx.fillStyle = '#ff4757';
                    ctx.fillRect(invader.x + 10, invader.y + 10, 40, 20);
                }
            });
            
            // çˆ†ç™ºã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®æç”»
            updateAndDrawExplosions();

            // è¢«å¼¾æ™‚ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
            if (playerHit) {
                ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
                ctx.font = 'bold 30px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('è¢«å¼¾ï¼', canvas.width / 2, canvas.height / 2 - 30);
                ctx.font = '20px Arial';
                ctx.fillText('ã‚¹ãƒšãƒ¼ã‚¹ã‚­ãƒ¼ã§å†é–‹', canvas.width / 2, canvas.height / 2 + 10);
                ctx.textAlign = 'left';
            }

            // UIæ›´æ–°
            document.getElementById('score').textContent = score;
            document.getElementById('lives').textContent = lives;
            document.getElementById('level').textContent = level;
        }
        
        // æ˜Ÿæç”»
        function drawStars() {
            ctx.fillStyle = '#ffffff';
            for (let i = 0; i < 50; i++) {
                let x = Math.random() * canvas.width;
                let y = Math.random() * canvas.height;
                ctx.fillRect(x, y, 1, 1);
            }
        }

        // çˆ†ç™ºã‚¨ãƒ•ã‚§ã‚¯ãƒˆç”Ÿæˆ
        function createExplosion(x, y) {
            for (let i = 0; i < 30; i++) {
                explosionParticles.push({
                    x: x,
                    y: y,
                    vx: Math.random() * 10 - 5,
                    vy: Math.random() * 10 - 5,
                    radius: Math.random() * 3 + 2,
                    life: 1.0,
                    color: `hsl(${Math.random() * 60 + 10}, 100%, 50%)` // èµ¤ã€œé»„è‰²
                });
            }
        }

        // çˆ†ç™ºã‚¨ãƒ•ã‚§ã‚¯ãƒˆæ›´æ–°ã¨æç”»
        function updateAndDrawExplosions() {
            explosionParticles = explosionParticles.filter(particle => {
                particle.x += particle.vx;
                particle.y += particle.vy;
                particle.life -= 0.02;
                particle.radius *= 0.98;

                if (particle.life > 0) {
                    ctx.globalAlpha = particle.life;
                    ctx.fillStyle = particle.color;
                    ctx.beginPath();
                    ctx.arc(particle.x, particle.y, particle.radius, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.globalAlpha = 1;
                    return true;
                }
                return false;
            });
        }
        
        // ã‚²ãƒ¼ãƒ å†é–‹
        function restartGame() {
            document.getElementById('gameOver').style.display = 'none';
            initGame();
        }
        
        // ã‚¹ã‚¿ãƒ¼ãƒˆç”»é¢è¡¨ç¤º
        function showStartScreen() {
            document.getElementById('gameOver').style.display = 'none';
            document.getElementById('startScreen').style.display = 'block';
            document.getElementById('gameCanvas').style.display = 'none';
            document.getElementById('gameUI').style.display = 'none';
            
            gameRunning = false;
        }
        
        // æ¤œç´¢æ©Ÿèƒ½
        function filterContent() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            // ã‚²ãƒ¼ãƒ å†…ã®æ¤œç´¢æ©Ÿèƒ½ï¼ˆå¿…è¦ã«å¿œã˜ã¦å®Ÿè£…ï¼‰
        }
    </script>
</body>
</html>
