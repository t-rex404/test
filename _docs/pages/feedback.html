<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ”¹å–„æ¡ˆãƒ•ã‚©ãƒ¼ãƒ  - PowerShell Driver Classes</title>
    <link rel="stylesheet" href="../css/styles.css">
    <style>
        .feedback-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .feedback-form {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-color);
        }
        
        .form-required {
            color: #e74c3c;
            margin-left: 5px;
        }
        
        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .radio-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .radio-item:hover {
            background: var(--hover-bg);
            border-color: var(--primary-color);
        }
        
        .radio-item input[type="radio"] {
            margin: 0;
        }
        
        .radio-item label {
            cursor: pointer;
            margin: 0;
            flex: 1;
        }
        
        .form-textarea {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-family: inherit;
            font-size: 14px;
            resize: vertical;
            background: var(--input-bg);
            color: var(--text-color);
        }
        
        .form-textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        .file-input-container {
            position: relative;
            display: inline-block;
            cursor: pointer;
            width: 100%;
        }
        
        .file-input-button {
            display: inline-block;
            padding: 12px 20px;
            background: var(--primary-color);
            color: white;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s ease;
            text-align: center;
            border: none;
            font-size: 14px;
        }
        
        .file-input-button:hover {
            background: var(--primary-hover);
        }
        
        .file-input {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
        
        .selected-files {
            margin-top: 15px;
            padding: 15px;
            background: var(--input-bg);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }
        
        .file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid var(--border-subtle);
        }
        
        .file-item:last-child {
            border-bottom: none;
        }
        
        .file-name {
            flex: 1;
            margin-right: 10px;
            word-break: break-all;
        }
        
        .remove-file {
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 4px 8px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .remove-file:hover {
            background: #c0392b;
        }
        
        .submit-button {
            background: var(--success-color);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s ease;
            width: 100%;
        }
        
        .submit-button:hover {
            background: var(--success-hover);
        }
        
        .submit-button:disabled {
            background: var(--disabled-color);
            cursor: not-allowed;
        }
        
        .back-button {
            background: var(--secondary-color);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: background 0.3s ease;
            text-decoration: none;
            display: inline-block;
            margin-bottom: 20px;
        }
        
        .back-button:hover {
            background: var(--secondary-hover);
        }
        
        .output-settings {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
        }
        
        .output-settings h3 {
            margin-top: 0;
            color: var(--text-color);
        }
        
        .output-path {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--input-bg);
            color: var(--text-color);
            font-family: monospace;
        }
        
        .success-message {
            background: var(--success-bg);
            color: var(--success-text);
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            text-align: center;
            display: none;
        }
        
        .error-message {
            background: var(--error-bg);
            color: var(--error-text);
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            text-align: center;
            display: none;
        }

        /* ãƒ¡ã‚½ãƒƒãƒ‰é¸æŠã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .method-container {
            margin-top: 15px;
        }

        .method-group {
            background: var(--input-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
        }

        .method-group h4 {
            margin: 0 0 15px 0;
            color: var(--text-primary);
            font-size: 1.1em;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 8px;
        }

        .method-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 12px;
        }

        .method-item {
            display: flex;
            flex-direction: column;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--card-bg);
        }

        .method-item:hover {
            background: var(--hover-bg);
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .method-item input[type="radio"] {
            margin: 0 0 8px 0;
        }

        .method-name {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 1em;
            margin-bottom: 5px;
        }

        .method-desc {
            color: var(--text-secondary);
            font-size: 0.9em;
            line-height: 1.4;
        }

        .method-item:has(input[type="radio"]:checked) {
            background: var(--primary-color);
            border-color: var(--primary-color);
            color: white;
        }

        .method-item:has(input[type="radio"]:checked) .method-name,
        .method-item:has(input[type="radio"]:checked) .method-desc {
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <h1 class="main-title">
                <span class="emoji">ğŸ“</span>
                æ”¹å–„æ¡ˆãƒ•ã‚©ãƒ¼ãƒ 
                <span class="emoji">ğŸ“</span>
            </h1>
            <p class="subtitle">PowerShell Driver Classesã®æ”¹å–„ã«ã”å”åŠ›ãã ã•ã„ï¼</p>
        </header>

        <!-- Back Button -->
        <a href="../index.html" class="back-button">â† ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹</a>

        <!-- Output Settings (Hidden) -->
        <div class="output-settings" style="display: none;">
            <h3>ğŸ“ CSVå‡ºåŠ›å…ˆã®è¨­å®š</h3>
            <p>CSVãƒ•ã‚¡ã‚¤ãƒ«ã®å‡ºåŠ›å…ˆãƒ•ã‚©ãƒ«ãƒ€ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ï¼š</p>
            <input type="text" id="outputPath" class="output-path" 
                   placeholder="ä¾‹: C:\Users\YourName\Desktop\feedback" 
                   value="C:\Users\YourName\Desktop\feedback">
            <p class="note">â€» ãƒ•ã‚©ãƒ«ãƒ€ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯è‡ªå‹•ã§ä½œæˆã•ã‚Œã¾ã™</p>
        </div>

        <!-- Feedback Form -->
        <div class="feedback-container">
            <form class="feedback-form" id="feedbackForm">
                <!-- Driver Selection -->
                <div class="form-group">
                    <label class="form-label">
                        ä¿®æ­£ã—ã¦ã»ã—ã„ã€æ©Ÿèƒ½ï¼ˆDriverãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
                        <span class="form-required">*</span>
                    </label>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" id="webdriver" name="driver" value="WebDriver" required>
                            <label for="webdriver">WebDriverï¼ˆãƒ–ãƒ©ã‚¦ã‚¶æ“ä½œã®åŸºåº•ã‚¯ãƒ©ã‚¹ï¼‰</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="chromedriver" name="driver" value="ChromeDriver" required>
                            <label for="chromedriver">ChromeDriverï¼ˆChromeãƒ–ãƒ©ã‚¦ã‚¶æ“ä½œï¼‰</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="edgedriver" name="driver" value="EdgeDriver" required>
                            <label for="edgedriver">EdgeDriverï¼ˆEdgeãƒ–ãƒ©ã‚¦ã‚¶æ“ä½œï¼‰</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="worddriver" name="driver" value="WordDriver" required>
                            <label for="worddriver">WordDriverï¼ˆWordæ“ä½œï¼‰</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="exceldriver" name="driver" value="ExcelDriver" required>
                            <label for="exceldriver">ExcelDriverï¼ˆExcelæ“ä½œï¼‰</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="powerpointdriver" name="driver" value="PowerPointDriver" required>
                            <label for="powerpointdriver">PowerPointDriverï¼ˆPowerPointæ“ä½œï¼‰</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="oracledriver" name="driver" value="OracleDriver" required>
                            <label for="oracledriver">OracleDriverï¼ˆOracle DBæ“ä½œï¼‰</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="common" name="driver" value="Common" required>
                            <label for="common">Commonï¼ˆå…±é€šæ©Ÿèƒ½ï¼‰</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="other" name="driver" value="ãã®ä»–" required>
                            <label for="other">ãã®ä»–</label>
                        </div>
                    </div>
                </div>

                <!-- Method Selection -->
                <div class="form-group" id="methodSelection" style="display: none;">
                    <label class="form-label">
                        ä¿®æ­£ã—ã¦ã»ã—ã„ã€ãƒ¡ã‚½ãƒƒãƒ‰
                        <span class="form-required">*</span>
                    </label>
                    <div class="method-container">
                        <!-- WebDriver Methods -->
                        <div class="method-group" id="webdriver-methods" style="display: none;">
                            <h4>WebDriver ãƒ¡ã‚½ãƒƒãƒ‰ä¸€è¦§</h4>
                            <div class="method-grid">
                                <label class="method-item">
                                    <input type="radio" name="method" value="NavigateTo" required>
                                    <span class="method-name">NavigateTo</span>
                                    <span class="method-desc">æŒ‡å®šã—ãŸURLã«ç§»å‹•</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="FindElement" required>
                                    <span class="method-name">FindElement</span>
                                    <span class="method-desc">è¦ç´ ã‚’æ¤œç´¢</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="ClickElement" required>
                                    <span class="method-name">ClickElement</span>
                                    <span class="method-desc">è¦ç´ ã‚’ã‚¯ãƒªãƒƒã‚¯</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="SendKeys" required>
                                    <span class="method-name">SendKeys</span>
                                    <span class="method-desc">ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="TakeScreenshot" required>
                                    <span class="method-name">TakeScreenshot</span>
                                    <span class="method-desc">ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆå–å¾—</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="GetCookies" required>
                                    <span class="method-name">GetCookies</span>
                                    <span class="method-desc">Cookieå–å¾—</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="ãã®ä»–" required>
                                    <span class="method-name">ãã®ä»–</span>
                                    <span class="method-desc">ä¸Šè¨˜ä»¥å¤–ã®ãƒ¡ã‚½ãƒƒãƒ‰</span>
                                </label>
                            </div>
                        </div>

                        <!-- ChromeDriver Methods -->
                        <div class="method-group" id="chromedriver-methods" style="display: none;">
                            <h4>ChromeDriver ãƒ¡ã‚½ãƒƒãƒ‰ä¸€è¦§</h4>
                            <div class="method-grid">
                                <label class="method-item">
                                    <input type="radio" name="method" value="SetChromeOptions" required>
                                    <span class="method-name">SetChromeOptions</span>
                                    <span class="method-desc">Chromeã‚ªãƒ—ã‚·ãƒ§ãƒ³è¨­å®š</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="SetHeadlessMode" required>
                                    <span class="method-name">SetHeadlessMode</span>
                                    <span class="method-desc">ãƒ˜ãƒƒãƒ‰ãƒ¬ã‚¹ãƒ¢ãƒ¼ãƒ‰è¨­å®š</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="SetUserAgent" required>
                                    <span class="method-name">SetUserAgent</span>
                                    <span class="method-desc">ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆè¨­å®š</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="ãã®ä»–" required>
                                    <span class="method-name">ãã®ä»–</span>
                                    <span class="method-desc">ä¸Šè¨˜ä»¥å¤–ã®ãƒ¡ã‚½ãƒƒãƒ‰</span>
                                </label>
                            </div>
                        </div>

                        <!-- EdgeDriver Methods -->
                        <div class="method-group" id="edgedriver-methods" style="display: none;">
                            <h4>EdgeDriver ãƒ¡ã‚½ãƒƒãƒ‰ä¸€è¦§</h4>
                            <div class="method-grid">
                                <label class="method-item">
                                    <input type="radio" name="method" value="SetEdgeOptions" required>
                                    <span class="method-name">SetEdgeOptions</span>
                                    <span class="method-desc">Edgeã‚ªãƒ—ã‚·ãƒ§ãƒ³è¨­å®š</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="SetEnterpriseMode" required>
                                    <span class="method-name">SetEnterpriseMode</span>
                                    <span class="method-desc">ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºãƒ¢ãƒ¼ãƒ‰è¨­å®š</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="ãã®ä»–" required>
                                    <span class="method-name">ãã®ä»–</span>
                                    <span class="method-desc">ä¸Šè¨˜ä»¥å¤–ã®ãƒ¡ã‚½ãƒƒãƒ‰</span>
                                </label>
                            </div>
                        </div>

                        <!-- WordDriver Methods -->
                        <div class="method-group" id="worddriver-methods" style="display: none;">
                            <h4>WordDriver ãƒ¡ã‚½ãƒƒãƒ‰ä¸€è¦§</h4>
                            <div class="method-grid">
                                <label class="method-item">
                                    <input type="radio" name="method" value="CreateDocument" required>
                                    <span class="method-name">CreateDocument</span>
                                    <span class="method-desc">æ–‡æ›¸ä½œæˆ</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="InsertText" required>
                                    <span class="method-name">InsertText</span>
                                    <span class="method-desc">ãƒ†ã‚­ã‚¹ãƒˆæŒ¿å…¥</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="InsertTable" required>
                                    <span class="method-name">InsertTable</span>
                                    <span class="method-desc">è¡¨æŒ¿å…¥</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="InsertImage" required>
                                    <span class="method-name">InsertImage</span>
                                    <span class="method-desc">ç”»åƒæŒ¿å…¥</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="ãã®ä»–" required>
                                    <span class="method-name">ãã®ä»–</span>
                                    <span class="method-desc">ä¸Šè¨˜ä»¥å¤–ã®ãƒ¡ã‚½ãƒƒãƒ‰</span>
                                </label>
                            </div>
                        </div>

                        <!-- ExcelDriver Methods -->
                        <div class="method-group" id="exceldriver-methods" style="display: none;">
                            <h4>ExcelDriver ãƒ¡ã‚½ãƒƒãƒ‰ä¸€è¦§</h4>
                            <div class="method-grid">
                                <label class="method-item">
                                    <input type="radio" name="method" value="CreateWorkbook" required>
                                    <span class="method-name">CreateWorkbook</span>
                                    <span class="method-desc">ãƒ¯ãƒ¼ã‚¯ãƒ–ãƒƒã‚¯ä½œæˆ</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="SetCellValue" required>
                                    <span class="method-name">SetCellValue</span>
                                    <span class="method-desc">ã‚»ãƒ«å€¤è¨­å®š</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="FormatCell" required>
                                    <span class="method-name">FormatCell</span>
                                    <span class="method-desc">ã‚»ãƒ«æ›¸å¼è¨­å®š</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="ãã®ä»–" required>
                                    <span class="method-name">ãã®ä»–</span>
                                    <span class="method-desc">ä¸Šè¨˜ä»¥å¤–ã®ãƒ¡ã‚½ãƒƒãƒ‰</span>
                                </label>
                            </div>
                        </div>

                        <!-- PowerPointDriver Methods -->
                        <div class="method-group" id="powerpointdriver-methods" style="display: none;">
                            <h4>PowerPointDriver ãƒ¡ã‚½ãƒƒãƒ‰ä¸€è¦§</h4>
                            <div class="method-grid">
                                <label class="method-item">
                                    <input type="radio" name="method" value="CreatePresentation" required>
                                    <span class="method-name">CreatePresentation</span>
                                    <span class="method-desc">ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ä½œæˆ</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="AddSlide" required>
                                    <span class="method-name">AddSlide</span>
                                    <span class="method-desc">ã‚¹ãƒ©ã‚¤ãƒ‰è¿½åŠ </span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="InsertShape" required>
                                    <span class="method-name">InsertShape</span>
                                    <span class="method-desc">å›³å½¢æŒ¿å…¥</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="ãã®ä»–" required>
                                    <span class="method-name">ãã®ä»–</span>
                                    <span class="method-desc">ä¸Šè¨˜ä»¥å¤–ã®ãƒ¡ã‚½ãƒƒãƒ‰</span>
                                </label>
                            </div>
                        </div>

                        <!-- OracleDriver Methods -->
                        <div class="method-group" id="oracledriver-methods" style="display: none;">
                            <h4>OracleDriver ãƒ¡ã‚½ãƒƒãƒ‰ä¸€è¦§</h4>
                            <div class="method-grid">
                                <label class="method-item">
                                    <input type="radio" name="method" value="Connect" required>
                                    <span class="method-name">Connect</span>
                                    <span class="method-desc">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶š</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="ExecuteQuery" required>
                                    <span class="method-name">ExecuteQuery</span>
                                    <span class="method-desc">ã‚¯ã‚¨ãƒªå®Ÿè¡Œ</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="ExecuteNonQuery" required>
                                    <span class="method-name">ExecuteNonQuery</span>
                                    <span class="method-desc">éã‚¯ã‚¨ãƒªå®Ÿè¡Œ</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="ãã®ä»–" required>
                                    <span class="method-name">ãã®ä»–</span>
                                    <span class="method-desc">ä¸Šè¨˜ä»¥å¤–ã®ãƒ¡ã‚½ãƒƒãƒ‰</span>
                                </label>
                            </div>
                        </div>

                        <!-- Common Methods -->
                        <div class="method-group" id="common-methods" style="display: none;">
                            <h4>Common ãƒ¡ã‚½ãƒƒãƒ‰ä¸€è¦§</h4>
                            <div class="method-grid">
                                <label class="method-item">
                                    <input type="radio" name="method" value="WriteLog" required>
                                    <span class="method-name">WriteLog</span>
                                    <span class="method-desc">ãƒ­ã‚°å‡ºåŠ›</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="HandleError" required>
                                    <span class="method-name">HandleError</span>
                                    <span class="method-desc">ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="ãã®ä»–" required>
                                    <span class="method-name">ãã®ä»–</span>
                                    <span class="method-desc">ä¸Šè¨˜ä»¥å¤–ã®ãƒ¡ã‚½ãƒƒãƒ‰</span>
                                </label>
                            </div>
                        </div>

                        <!-- Other Methods -->
                        <div class="method-group" id="other-methods" style="display: none;">
                            <h4>ãã®ä»–ã®æ©Ÿèƒ½</h4>
                            <div class="method-grid">
                                <label class="method-item">
                                    <input type="radio" name="method" value="æ–°æ©Ÿèƒ½ææ¡ˆ" required>
                                    <span class="method-name">æ–°æ©Ÿèƒ½ææ¡ˆ</span>
                                    <span class="method-desc">æ–°ã—ã„æ©Ÿèƒ½ã®ææ¡ˆ</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ”¹å–„" required>
                                    <span class="method-name">ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ”¹å–„</span>
                                    <span class="method-desc">ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æ”¹å–„ææ¡ˆ</span>
                                </label>
                                <label class="method-item">
                                    <input type="radio" name="method" value="ãã®ä»–" required>
                                    <span class="method-name">ãã®ä»–</span>
                                    <span class="method-desc">ä¸Šè¨˜ä»¥å¤–ã®å†…å®¹</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Improvement Content -->
                <div class="form-group">
                    <label class="form-label" for="improvementContent">
                        ä¿®æ­£ã¾ãŸã¯ã€æ”¹å–„ã—ã¦ã»ã—ã„å†…å®¹ï¼ˆå•é¡Œç‚¹ãªã©ï¼‰ã§ãã‚‹ã ã‘è©³ã—ãæ›¸ã„ã¦ãã ã•ã„ã€‚
                        <span class="form-required">*</span>
                    </label>
                    <textarea 
                        id="improvementContent" 
                        name="improvementContent" 
                        class="form-textarea" 
                        placeholder="å…·ä½“çš„ãªå•é¡Œç‚¹ã‚„æ”¹å–„æ¡ˆã‚’è©³ã—ãè¨˜å…¥ã—ã¦ãã ã•ã„ã€‚ä¾‹ï¼šã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€æœŸå¾…ã™ã‚‹å‹•ä½œã€ç¾åœ¨ã®å‹•ä½œãªã©..."
                        required
                    ></textarea>
                </div>

                <!-- Reference Files -->
                <div class="form-group">
                    <label class="form-label">
                        å‚è€ƒãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆå®Ÿè¡Œã—ãŸã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚„ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã€ç”»é¢ã®ãƒãƒ¼ãƒ‰ã‚³ãƒ”ãƒ¼ãªã©ï¼‰
                    </label>
                    <div class="file-input-container">
                        <input type="file" id="referenceFiles" class="file-input" multiple accept="*.*">
                        <div class="file-input-button">ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ</div>
                    </div>
                    <div class="selected-files" id="selectedFiles" style="display: none;">
                        <p><strong>é¸æŠã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ï¼š</strong></p>
                        <div id="fileList"></div>
                    </div>
                </div>

                <!-- Submit Button -->
                <button type="submit" class="submit-button" id="submitButton">
                    ğŸ“¤ ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’é€ä¿¡
                </button>
            </form>

            <!-- Success/Error Messages -->
            <div class="success-message" id="successMessage">
                âœ… ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãŒæ­£å¸¸ã«é€ä¿¡ã•ã‚Œã¾ã—ãŸï¼CSVãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œã¦ã„ã¾ã™ã€‚
            </div>
            <div class="error-message" id="errorMessage">
                âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚
            </div>
        </div>
    </div>

    <script>
        // ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠå‡¦ç†
        document.getElementById('referenceFiles').addEventListener('change', function(e) {
            const files = Array.from(e.target.files);
            const fileList = document.getElementById('fileList');
            const selectedFiles = document.getElementById('selectedFiles');
            
            if (files.length > 0) {
                selectedFiles.style.display = 'block';
                fileList.innerHTML = '';
                
                files.forEach((file, index) => {
                    const fileItem = document.createElement('div');
                    fileItem.className = 'file-item';
                    fileItem.innerHTML = `
                        <span class="file-name">${file.name}</span>
                        <button type="button" class="remove-file" onclick="removeFile(${index})">å‰Šé™¤</button>
                    `;
                    fileList.appendChild(fileItem);
                });
            } else {
                selectedFiles.style.display = 'none';
            }
        });

        // ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤å‡¦ç†
        function removeFile(index) {
            const input = document.getElementById('referenceFiles');
            const dt = new DataTransfer();
            const files = Array.from(input.files);
            
            files.splice(index, 1);
            files.forEach(file => dt.items.add(file));
            input.files = dt.files;
            
            // è¡¨ç¤ºã‚’æ›´æ–°
            const event = new Event('change');
            input.dispatchEvent(event);
        }

        // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡å‡¦ç†
        document.getElementById('feedbackForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitButton = document.getElementById('submitButton');
            const successMessage = document.getElementById('successMessage');
            const errorMessage = document.getElementById('errorMessage');
            
            // ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–
            submitButton.disabled = true;
            submitButton.textContent = 'ğŸ“¤ é€ä¿¡ä¸­...';
            
            try {
                // ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
                const formData = new FormData(e.target);
                const driver = formData.get('driver');
                const method = formData.get('method') || 'æœªé¸æŠ';
                const improvementContent = formData.get('improvementContent');
                const files = Array.from(document.getElementById('referenceFiles').files);
                
                // ç¾åœ¨æ™‚åˆ»ã‚’å–å¾—ï¼ˆãƒŸãƒªç§’ã¾ã§ï¼‰
                const now = new Date();
                const timestamp = now.getFullYear().toString() +
                               String(now.getMonth() + 1).padStart(2, '0') +
                               String(now.getDate()).padStart(2, '0') +
                               String(now.getHours()).padStart(2, '0') +
                               String(now.getMinutes()).padStart(2, '0') +
                               String(now.getSeconds()).padStart(2, '0') +
                               String(now.getMilliseconds()).padStart(3, '0');
                
                // IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—
                let ipAddress = 'Unknown';
                try {
                    // å¤–éƒ¨APIã‚’ä½¿ç”¨ã—ã¦IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—
                    const response = await fetch('https://api.ipify.org?format=json');
                    const data = await response.json();
                    ipAddress = data.ip;
                } catch (error) {
                    console.log('IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ:', error);
                    ipAddress = 'Unknown';
                }
                
                // ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’æ–‡å­—åˆ—åŒ–
                const filePaths = files.map(file => file.name).join('; ');
                
                // CSVãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ
                const csvData = [
                    driver,
                    method,
                    improvementContent,
                    filePaths,
                    ipAddress,
                    timestamp
                ].map(field => `"${field}"`).join(',');
                
                const csvContent = 'ä¿®æ­£ã—ã¦ã»ã—ã„æ©Ÿèƒ½,ä¿®æ­£ã—ã¦ã»ã—ã„ãƒ¡ã‚½ãƒƒãƒ‰,ä¿®æ­£ã¾ãŸã¯æ”¹å–„ã—ã¦ã»ã—ã„å†…å®¹,å‚è€ƒãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹,IPã‚¢ãƒ‰ãƒ¬ã‚¹,ä½œæˆæ™‚é–“\n' + csvData;
                
                // å‡ºåŠ›å…ˆãƒ‘ã‚¹ã‚’å–å¾—
                const outputPath = document.getElementById('outputPath').value.trim();
                if (!outputPath) {
                    throw new Error('å‡ºåŠ›å…ˆãƒ‘ã‚¹ãŒæŒ‡å®šã•ã‚Œã¦ã„ã¾ã›ã‚“');
                }
                
                // ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ç”Ÿæˆ
                const fileName = `${timestamp}.csv`;
                
                // CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', fileName);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
                successMessage.style.display = 'block';
                errorMessage.style.display = 'none';
                
                // ãƒ•ã‚©ãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆ
                e.target.reset();
                document.getElementById('selectedFiles').style.display = 'none';
                
            } catch (error) {
                console.error('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
                errorMessage.textContent = `âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error.message}`;
                errorMessage.style.display = 'block';
                successMessage.style.display = 'none';
            } finally {
                // ãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–
                submitButton.disabled = false;
                submitButton.textContent = 'ğŸ“¤ ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’é€ä¿¡';
            }
        });

        // Driveré¸æŠæ™‚ã®ãƒ¡ã‚½ãƒƒãƒ‰è¡¨ç¤ºå‡¦ç†
        document.querySelectorAll('input[name="driver"]').forEach(function(radio) {
            radio.addEventListener('change', function() {
                const methodSelection = document.getElementById('methodSelection');
                const selectedDriver = this.value;
                
                // ã™ã¹ã¦ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚°ãƒ«ãƒ¼ãƒ—ã‚’éè¡¨ç¤º
                document.querySelectorAll('.method-group').forEach(function(group) {
                    group.style.display = 'none';
                });
                
                // é¸æŠã•ã‚ŒãŸDriverã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚°ãƒ«ãƒ¼ãƒ—ã‚’è¡¨ç¤º
                if (selectedDriver !== 'ãã®ä»–') {
                    const methodGroupId = selectedDriver.toLowerCase() + '-methods';
                    const methodGroup = document.getElementById(methodGroupId);
                    if (methodGroup) {
                        methodGroup.style.display = 'block';
                    }
                } else {
                    // ãã®ä»–ã®å ´åˆã¯ã€Œãã®ä»–ã®æ©Ÿèƒ½ã€ã‚’è¡¨ç¤º
                    const otherMethods = document.getElementById('other-methods');
                    if (otherMethods) {
                        otherMethods.style.display = 'block';
                    }
                }
                
                // ãƒ¡ã‚½ãƒƒãƒ‰é¸æŠã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¡¨ç¤º
                methodSelection.style.display = 'block';
                
                // æ—¢å­˜ã®ãƒ¡ã‚½ãƒƒãƒ‰é¸æŠã‚’ã‚¯ãƒªã‚¢
                document.querySelectorAll('input[name="method"]').forEach(function(methodRadio) {
                    methodRadio.checked = false;
                });
            });
        });

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®å‡¦ç†
        document.addEventListener('DOMContentLoaded', function() {
            // ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®çŠ¶æ…‹ã‚’å¾©å…ƒ
            const isDarkMode = localStorage.getItem('darkMode') === 'true';
            if (isDarkMode) {
                document.body.classList.add('dark-mode');
            }
        });
    </script>
</body>
</html>
